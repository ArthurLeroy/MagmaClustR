<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="In MagmaClust, as for any clustering method, the number K of clusters has to
be provided as an hypothesis of the model. This function implements a model
selection procedure, by maximising a variational BIC criterion, computed
for different values of K. A heuristic for a fast approximation of the
procedure is proposed as well, although the corresponding models would not
be properly trained."><title>Select the optimal number of clusters — select_nb_cluster • MagmaClustR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Select the optimal number of clusters — select_nb_cluster"><meta property="og:description" content="In MagmaClust, as for any clustering method, the number K of clusters has to
be provided as an hypothesis of the model. This function implements a model
selection procedure, by maximising a variational BIC criterion, computed
for different values of K. A heuristic for a fast approximation of the
procedure is proposed as well, although the corresponding models would not
be properly trained."><meta property="og:image" content="https://arthurleroy.github.io/MagmaClustR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MagmaClustR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ArthurLeroy/MagmaClustR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Select the optimal number of clusters</h1>
      <small class="dont-index">Source: <a href="https://github.com/ArthurLeroy/MagmaClustR/blob/HEAD/R/training.R" class="external-link"><code>R/training.R</code></a></small>
      <div class="d-none name"><code>select_nb_cluster.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In MagmaClust, as for any clustering method, the number K of clusters has to
be provided as an hypothesis of the model. This function implements a model
selection procedure, by maximising a variational BIC criterion, computed
for different values of K. A heuristic for a fast approximation of the
procedure is proposed as well, although the corresponding models would not
be properly trained.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">select_nb_cluster</span><span class="op">(</span>
  <span class="va">data</span>,
  fast_approx <span class="op">=</span> <span class="cn">TRUE</span>,
  grid_nb_cluster <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,
  ini_hp_k <span class="op">=</span> <span class="cn">NULL</span>,
  ini_hp_i <span class="op">=</span> <span class="cn">NULL</span>,
  kern_k <span class="op">=</span> <span class="st">"SE"</span>,
  kern_i <span class="op">=</span> <span class="st">"SE"</span>,
  plot <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A tibble or data frame. Columns required: <code>ID</code>, <code>Input</code>
, <code>Output</code>. Additional columns for covariates can be specified.
The <code>ID</code> column contains the unique names/codes used to identify each
individual/task (or batch of data).
The <code>Input</code> column should define the variable that is used as
reference for the observations (e.g. time for longitudinal data). The
<code>Output</code> column specifies the observed values (the response
variable). The data frame can also provide as many covariates as desired,
with no constraints on the column names. These covariates are additional
inputs (explanatory variables) of the models that are also observed at
each reference <code>Input</code>.</p></dd>


<dt>fast_approx</dt>
<dd><p>A boolean, indicating whether a fast approximation should
be used for selecting the number of clusters. If TRUE, each Magma or
MagmaClust model will perform only one E-step of the training, using
the same fixed values for the hyper-parameters (<code>ini_hp_k</code> and
<code>ini_hp_i</code>, or random values if not provided) in all models. The
resulting models should not be considered as trained, but this approach
provides an convenient heuristic to avoid a cumbersome model selection
procedure.</p></dd>


<dt>grid_nb_cluster</dt>
<dd><p>A vector of integer, corresponding to grid of values
that will be tested for the number of clusters.</p></dd>


<dt>ini_hp_k</dt>
<dd><p>A tibble or data frame of hyper-parameters associated with
<code>kern_k</code>.</p></dd>


<dt>ini_hp_i</dt>
<dd><p>A tibble or data frame of hyper-parameters associated with
<code>kern_i</code>.</p></dd>


<dt>kern_k</dt>
<dd><p>A kernel function associated to the mean processes.</p></dd>


<dt>kern_i</dt>
<dd><p>A kernel function associated to the individuals/tasks.</p></dd>


<dt>plot</dt>
<dd><p>A boolean indicating whether the plot of V-BIC values for all
numbers of clusters should displayed.</p></dd>


<dt>...</dt>
<dd><p>Any additional argument that could be passed to
<code><a href="train_magmaclust.html">train_magmaclust</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list, containing the results of model selection procedure for
selecting the optimal number of clusters thanks to a V-BIC criterion
maximisation. The elements of the list are:</p><ul><li><p>best_k: An integer, indicating the resulting optimal number of clusters</p></li>
<li><p>seq_vbic: A vector, corresponding to the sequence of the V-BIC values
associated with the models trained for each provided cluster's number in
<code>grid_nb_cluster</code>.</p></li>
<li><p>trained_models: A list, named by associated number of clusters, of
Magma or MagmaClust models that have been trained (or approximated if
<code>fast_approx</code> = T) during the model selection procedure.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="cn">TRUE</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Arthur Leroy, Pierre Latouche.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer></div>

  

  

  </body></html>

