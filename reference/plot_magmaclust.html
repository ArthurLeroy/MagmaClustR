<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot MagmaClust predictions — plot_magmaclust • MagmaClustR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot MagmaClust predictions — plot_magmaclust"><meta name="description" content="Display MagmaClust predictions. According to the dimension of the
inputs, the graph may be a mean curve (dim inputs = 1) or a heatmap
(dim inputs = 2) of probabilities. Moreover, MagmaClust can provide credible
intervals only by visualising cluster-specific predictions (e.g. for the most
probable cluster). When visualising the full mixture-of-GPs prediction,
which can be multimodal, the user should choose between the simple mean
function or the full heatmap of probabilities (more informative but slower)."><meta property="og:description" content="Display MagmaClust predictions. According to the dimension of the
inputs, the graph may be a mean curve (dim inputs = 1) or a heatmap
(dim inputs = 2) of probabilities. Moreover, MagmaClust can provide credible
intervals only by visualising cluster-specific predictions (e.g. for the most
probable cluster). When visualising the full mixture-of-GPs prediction,
which can be multimodal, the user should choose between the simple mean
function or the full heatmap of probabilities (more informative but slower)."><meta property="og:image" content="https://arthurleroy.github.io/MagmaClustR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MagmaClustR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/example-in-2D.html">Multi-dimensional inputs in Magma</a></li>
    <li><a class="dropdown-item" href="../articles/how-to-use-magma.html">How to use Magma</a></li>
    <li><a class="dropdown-item" href="../articles/how-to-use-magmaclust.html">How to use MagmaClust</a></li>
    <li><a class="dropdown-item" href="../articles/standard-GP.html">Gaussian Process regression</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ArthurLeroy/MagmaClustR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot MagmaClust predictions</h1>
      <small class="dont-index">Source: <a href="https://github.com/ArthurLeroy/MagmaClustR/blob/master/R/plot-functions.R" class="external-link"><code>R/plot-functions.R</code></a></small>
      <div class="d-none name"><code>plot_magmaclust.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Display MagmaClust predictions. According to the dimension of the
inputs, the graph may be a mean curve (dim inputs = 1) or a heatmap
(dim inputs = 2) of probabilities. Moreover, MagmaClust can provide credible
intervals only by visualising cluster-specific predictions (e.g. for the most
probable cluster). When visualising the full mixture-of-GPs prediction,
which can be multimodal, the user should choose between the simple mean
function or the full heatmap of probabilities (more informative but slower).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_magmaclust</span><span class="op">(</span></span>
<span>  <span class="va">pred_clust</span>,</span>
<span>  cluster <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  x_input <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data_train <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_clust <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prior_mean <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_grid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  heatmap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  samples <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nb_samples <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  plot_mean <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  alpha_samples <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  prob_CI <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  size_data <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  size_data_train <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha_data_train <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pred-clust">pred_clust<a class="anchor" aria-label="anchor" href="#arg-pred-clust"></a></dt>
<dd><p>A list of predictions, typically coming from
<code><a href="pred_magmaclust.html">pred_magmaclust</a></code>. Required elements: <code>pred</code>,
<code>mixture</code>, <code>mixture_pred</code>.</p></dd>


<dt id="arg-cluster">cluster<a class="anchor" aria-label="anchor" href="#arg-cluster"></a></dt>
<dd><p>A character string, indicating which cluster to plot from.
If 'all' (default) the mixture of GPs prediction is displayed as a mean
curve (1-D inputs) or a mean heatmap (2-D inputs). Alternatively, if the
name of one cluster is provided, the classic mean curve + credible
interval is displayed (1-D inputs), or a heatmap with colour gradient for
the mean and transparency gradient for the Credible Interval (2-D inputs).</p></dd>


<dt id="arg-x-input">x_input<a class="anchor" aria-label="anchor" href="#arg-x-input"></a></dt>
<dd><p>A vector of character strings, indicating which input should
be displayed. If NULL (default) the 'Input' column is used for the x-axis.
If providing a 2-dimensional vector, the corresponding columns are used
for the x-axis and y-axis.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>(Optional) A tibble or data frame. Required columns: <code>Input</code>
, <code>Output</code>. Additional columns for covariates can be specified. This
argument corresponds to the raw data on which the prediction has been
performed.</p></dd>


<dt id="arg-data-train">data_train<a class="anchor" aria-label="anchor" href="#arg-data-train"></a></dt>
<dd><p>(Optional) A tibble or data frame, containing the training
data of the MagmaClust model. The data set should have the same format as
the <code>data</code> argument with an additional required column <code>ID</code> for
identifying the different individuals/tasks. If provided, those data are
displayed as backward colourful points (each colour corresponding to one
individual or a cluster, see <code>col_clust</code> below).</p></dd>


<dt id="arg-col-clust">col_clust<a class="anchor" aria-label="anchor" href="#arg-col-clust"></a></dt>
<dd><p>A boolean indicating whether backward points are coloured
according to the individuals or to their most probable cluster. If one
wants to colour by clusters, a column <code>Cluster</code> shall be present in
<code>data_train</code>. We advise to use <code><a href="data_allocate_cluster.html">data_allocate_cluster</a></code>
for automatically creating a well-formatted dataset from a trained
MagmaClust model.</p></dd>


<dt id="arg-prior-mean">prior_mean<a class="anchor" aria-label="anchor" href="#arg-prior-mean"></a></dt>
<dd><p>(Optional) A list providing, for each cluster, a
tibble containing prior mean parameters of the prediction. This argument
typically comes as an outcome <code>hyperpost$mean</code>, available through
the <code><a href="train_magmaclust.html">train_magmaclust</a></code>, <code><a href="pred_magmaclust.html">pred_magmaclust</a></code>
functions.</p></dd>


<dt id="arg-y-grid">y_grid<a class="anchor" aria-label="anchor" href="#arg-y-grid"></a></dt>
<dd><p>A vector, indicating the grid of values on the y-axis for which
probabilities should be computed for heatmaps of 1-dimensional
predictions. If NULL (default), a vector of length 50 is defined, ranging
between the min and max 'Output' values contained in <code>pred</code>.</p></dd>


<dt id="arg-heatmap">heatmap<a class="anchor" aria-label="anchor" href="#arg-heatmap"></a></dt>
<dd><p>A logical value indicating whether the GP mixture should be
represented as a heatmap of probabilities for 1-dimensional inputs. If
FALSE (default), the mean curve (and associated Credible Interval if
available) are displayed.</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>A logical value indicating whether the GP mixture should be
represented as a collection of samples drawn from the posterior. If
FALSE (default), the mean curve (and associated Credible Interval if
available) are displayed.</p></dd>


<dt id="arg-nb-samples">nb_samples<a class="anchor" aria-label="anchor" href="#arg-nb-samples"></a></dt>
<dd><p>A number, indicating the number of samples to be drawn from
the predictive posterior distribution. For two-dimensional graphs, only
one sample can be displayed.</p></dd>


<dt id="arg-plot-mean">plot_mean<a class="anchor" aria-label="anchor" href="#arg-plot-mean"></a></dt>
<dd><p>A logical value, indicating whether the mean prediction
should be displayed on the graph when <code>samples = TRUE</code>.</p></dd>


<dt id="arg-alpha-samples">alpha_samples<a class="anchor" aria-label="anchor" href="#arg-alpha-samples"></a></dt>
<dd><p>A number, controlling transparency of the sample curves.</p></dd>


<dt id="arg-prob-ci">prob_CI<a class="anchor" aria-label="anchor" href="#arg-prob-ci"></a></dt>
<dd><p>A number between 0 and 1 (default is 0.95), indicating the
level of the Credible Interval associated with the posterior mean curve.
If this this argument is set to 1, the Credible Interval is not displayed.</p></dd>


<dt id="arg-size-data">size_data<a class="anchor" aria-label="anchor" href="#arg-size-data"></a></dt>
<dd><p>A number, controlling the size of the <code>data</code> points.</p></dd>


<dt id="arg-size-data-train">size_data_train<a class="anchor" aria-label="anchor" href="#arg-size-data-train"></a></dt>
<dd><p>A number, controlling the size of the
<code>data_train</code> points.</p></dd>


<dt id="arg-alpha-data-train">alpha_data_train<a class="anchor" aria-label="anchor" href="#arg-alpha-data-train"></a></dt>
<dd><p>A number, between 0 and 1, controlling transparency
of the <code>data_train</code> points.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Visualisation of a MagmaClust prediction (optional: display data
points, training data points and the prior mean functions). For 1-D
inputs, the prediction is represented as a mean curve (and its associated
95% Credible Interval for cluster-specific predictions), or as a heatmap
of probabilities if <code>heatmap</code> = TRUE. In the case of MagmaClust,
the heatmap representation should be preferred for clarity, although the
default display remains mean curve for quicker execution. For 2-D inputs,
the prediction is represented as a heatmap, where each couple of inputs on
the x-axis and y-axis are associated with a gradient of colours for the
posterior mean values, whereas the uncertainty is indicated by the
transparency (the narrower is the Credible Interval, the more opaque is
the associated colour, and vice versa). As for 1-D inputs, Credible
Interval information is only available for cluster-specific predictions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="cn">TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Arthur Leroy, Pierre Latouche.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

