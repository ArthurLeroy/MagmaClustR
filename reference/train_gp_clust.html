<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Prediction in MagmaClust: learning new HPs and mixture probabilities — train_gp_clust • MagmaClustR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prediction in MagmaClust: learning new HPs and mixture probabilities — train_gp_clust"><meta name="description" content="Learning hyper-parameters and mixture probabilities of any new
individual/task is required in MagmaClust in the prediction procedure.
By providing data for the new individual/task, the hyper-posterior mean and
covariance parameters, the mixture proportions, and initialisation values for
the hyper-parameters, train_gp_clust uses an EM algorithm to compute
maximum likelihood estimates of the hyper-parameters and hyper-posterior
mixture probabilities of the new individual/task."><meta property="og:description" content="Learning hyper-parameters and mixture probabilities of any new
individual/task is required in MagmaClust in the prediction procedure.
By providing data for the new individual/task, the hyper-posterior mean and
covariance parameters, the mixture proportions, and initialisation values for
the hyper-parameters, train_gp_clust uses an EM algorithm to compute
maximum likelihood estimates of the hyper-parameters and hyper-posterior
mixture probabilities of the new individual/task."><meta property="og:image" content="https://arthurleroy.github.io/MagmaClustR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MagmaClustR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/example-in-2D.html">Multi-dimensional inputs in Magma</a></li>
    <li><a class="dropdown-item" href="../articles/how-to-use-magma.html">How to use Magma</a></li>
    <li><a class="dropdown-item" href="../articles/how-to-use-magmaclust.html">How to use MagmaClust</a></li>
    <li><a class="dropdown-item" href="../articles/standard-GP.html">Gaussian Process regression</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ArthurLeroy/MagmaClustR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Prediction in MagmaClust: learning new HPs and mixture probabilities</h1>
      <small class="dont-index">Source: <a href="https://github.com/ArthurLeroy/MagmaClustR/blob/master/R/training.R" class="external-link"><code>R/training.R</code></a></small>
      <div class="d-none name"><code>train_gp_clust.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Learning hyper-parameters and mixture probabilities of any new
individual/task is required in <code>MagmaClust</code> in the prediction procedure.
By providing data for the new individual/task, the hyper-posterior mean and
covariance parameters, the mixture proportions, and initialisation values for
the hyper-parameters, <code>train_gp_clust</code> uses an EM algorithm to compute
maximum likelihood estimates of the hyper-parameters and hyper-posterior
mixture probabilities of the new individual/task.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">train_gp_clust</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  prop_mixture <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ini_hp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  kern <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>  hyperpost <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pen_diag <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>  n_iter_max <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  cv_threshold <span class="op">=</span> <span class="fl">0.001</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A tibble or data frame. Required columns: <code>Input</code>,
<code>Output</code>. Additional columns for covariates can be specified.
The <code>Input</code> column should define the variable that is used as
reference for the observations (e.g. time for longitudinal data). The
<code>Output</code> column specifies the observed values (the response
variable). The data frame can also provide as many covariates as desired,
with no constraints on the column names. These covariates are additional
inputs (explanatory variables) of the models that are also observed at
each reference <code>Input</code>.</p></dd>


<dt id="arg-prop-mixture">prop_mixture<a class="anchor" aria-label="anchor" href="#arg-prop-mixture"></a></dt>
<dd><p>A tibble or a named vector. Each name of column or
element should refer to a cluster. The value associated with each cluster
is a number between 0 and 1, corresponding to the mixture
proportions.</p></dd>


<dt id="arg-ini-hp">ini_hp<a class="anchor" aria-label="anchor" href="#arg-ini-hp"></a></dt>
<dd><p>A tibble or data frame of hyper-parameters
associated with <code>kern</code>, the individual process kernel. The
<code><a href="hp.html">hp</a></code> function can be used to draw custom hyper-parameters with
the correct format.</p></dd>


<dt id="arg-kern">kern<a class="anchor" aria-label="anchor" href="#arg-kern"></a></dt>
<dd><p>A kernel function, defining the covariance structure of the GP.
Several popular kernels
(see <a href="https://www.cs.toronto.edu/~duvenaud/cookbook/" class="external-link">The Kernel
Cookbook</a>) are already implemented and can be selected within the
following list:</p><ul><li><p>"SE": (default value) the Squared Exponential Kernel (also called
Radial Basis Function or Gaussian kernel),</p></li>
<li><p>"LIN": the Linear kernel,</p></li>
<li><p>"PERIO": the Periodic kernel,</p></li>
<li><p>"RQ": the Rational Quadratic kernel.
Compound kernels can be created as sums or products of the above kernels.
For combining kernels, simply provide a formula as a character string
where elements are separated by whitespaces (e.g. "SE + PERIO"). As the
elements are treated sequentially from the left to the right, the product
operator '*' shall always be used before the '+' operators (e.g.
'SE * LIN + RQ' is valid whereas 'RQ + SE * LIN' is  not).</p></li>
</ul></dd>


<dt id="arg-hyperpost">hyperpost<a class="anchor" aria-label="anchor" href="#arg-hyperpost"></a></dt>
<dd><p>A list, containing the elements <code>mean</code>, <code>cov</code> and
<code>mixture</code> the parameters of the hyper-posterior distributions of the
mean processes. Typically, this argument should come from a previous
learning using <code><a href="train_magmaclust.html">train_magmaclust</a></code>, or a previous prediction
with <code><a href="pred_magmaclust.html">pred_magmaclust</a></code>, with the argument <code>get_hyperpost</code>
set to TRUE.</p></dd>


<dt id="arg-pen-diag">pen_diag<a class="anchor" aria-label="anchor" href="#arg-pen-diag"></a></dt>
<dd><p>A number. A jitter term, added on the diagonal to prevent
numerical issues when inverting nearly singular matrices.</p></dd>


<dt id="arg-n-iter-max">n_iter_max<a class="anchor" aria-label="anchor" href="#arg-n-iter-max"></a></dt>
<dd><p>A number, indicating the maximum number of iterations of
the EM algorithm to proceed while not reaching convergence.</p></dd>


<dt id="arg-cv-threshold">cv_threshold<a class="anchor" aria-label="anchor" href="#arg-cv-threshold"></a></dt>
<dd><p>A number, indicating the threshold of the likelihood gain
under which the EM algorithm will stop.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list, containing the results of the EM algorithm used during the
prediction step of MagmaClust. The elements of the list are:</p><ul><li><p>hp: A tibble of optimal hyper-parameters for the new individual's GP.</p></li>
<li><p>mixture: A tibble of mixture probabilities for the new individual.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="cn">TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Arthur Leroy, Pierre Latouche.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

