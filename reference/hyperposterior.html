<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute the hyper-posterior distribution in Magma — hyperposterior • MagmaClustR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute the hyper-posterior distribution in Magma — hyperposterior"><meta name="description" content="Compute the parameters of the hyper-posterior Gaussian distribution of the
mean process in Magma (similarly to the expectation step of the EM
algorithm used for learning). This hyper-posterior distribution, evaluated
on a grid of inputs provided through the grid_inputs argument, is a
key component for making prediction in Magma, and is required in the function
pred_magma."><meta property="og:description" content="Compute the parameters of the hyper-posterior Gaussian distribution of the
mean process in Magma (similarly to the expectation step of the EM
algorithm used for learning). This hyper-posterior distribution, evaluated
on a grid of inputs provided through the grid_inputs argument, is a
key component for making prediction in Magma, and is required in the function
pred_magma."><meta property="og:image" content="https://arthurleroy.github.io/MagmaClustR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MagmaClustR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/example-in-2D.html">Multi-dimensional inputs in Magma</a></li>
    <li><a class="dropdown-item" href="../articles/how-to-use-magma.html">How to use Magma</a></li>
    <li><a class="dropdown-item" href="../articles/how-to-use-magmaclust.html">How to use MagmaClust</a></li>
    <li><a class="dropdown-item" href="../articles/standard-GP.html">Gaussian Process regression</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ArthurLeroy/MagmaClustR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute the hyper-posterior distribution in Magma</h1>
      <small class="dont-index">Source: <a href="https://github.com/ArthurLeroy/MagmaClustR/blob/master/R/prediction.R" class="external-link"><code>R/prediction.R</code></a></small>
      <div class="d-none name"><code>hyperposterior.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute the parameters of the hyper-posterior Gaussian distribution of the
mean process in Magma (similarly to the expectation step of the EM
algorithm used for learning). This hyper-posterior distribution, evaluated
on a grid of inputs provided through the <code>grid_inputs</code> argument, is a
key component for making prediction in Magma, and is required in the function
<code><a href="pred_magma.html">pred_magma</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hyperposterior</span><span class="op">(</span></span>
<span>  trained_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hp_0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hp_i <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  kern_0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  kern_i <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior_mean <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  grid_inputs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pen_diag <span class="op">=</span> <span class="fl">1e-10</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-trained-model">trained_model<a class="anchor" aria-label="anchor" href="#arg-trained-model"></a></dt>
<dd><p>A list, containing  the information coming from a
Magma model, previously trained using the <code><a href="train_magma.html">train_magma</a></code>
function. If <code>trained_model</code> is not provided, the arguments
<code>data</code>, <code>hp_0</code>, <code>hp_i</code>, <code>kern_0</code>, and <code>kern_i</code>
are all required.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A tibble or data frame. Required columns: 'Input',
'Output'. Additional columns for covariates can be specified.
The 'Input' column should define the variable that is used as
reference for the observations (e.g. time for longitudinal data). The
'Output' column specifies the observed values (the response
variable). The data frame can also provide as many covariates as desired,
with no constraints on the column names. These covariates are additional
inputs (explanatory variables) of the models that are also observed at
each reference 'Input'. Recovered from <code>trained_model</code> if not
provided.</p></dd>


<dt id="arg-hp-">hp_0<a class="anchor" aria-label="anchor" href="#arg-hp-"></a></dt>
<dd><p>A named vector, tibble or data frame of hyper-parameters
associated with <code>kern_0</code>. Recovered from <code>trained_model</code> if not
provided.</p></dd>


<dt id="arg-hp-i">hp_i<a class="anchor" aria-label="anchor" href="#arg-hp-i"></a></dt>
<dd><p>A tibble or data frame of hyper-parameters
associated with <code>kern_i</code>. Recovered from <code>trained_model</code> if not
provided.</p></dd>


<dt id="arg-kern-">kern_0<a class="anchor" aria-label="anchor" href="#arg-kern-"></a></dt>
<dd><p>A kernel function, associated with the mean GP.
Several popular kernels
(see <a href="https://www.cs.toronto.edu/~duvenaud/cookbook/" class="external-link">The Kernel
Cookbook</a>) are already implemented and can be selected within the
following list:</p><ul><li><p>"SE": (default value) the Squared Exponential Kernel (also called
Radial Basis Function or Gaussian kernel),</p></li>
<li><p>"LIN": the Linear kernel,</p></li>
<li><p>"PERIO": the Periodic kernel,</p></li>
<li><p>"RQ": the Rational Quadratic kernel.
Compound kernels can be created as sums or products of the above kernels.
For combining kernels, simply provide a formula as a character string
where elements are separated by whitespaces (e.g. "SE + PERIO"). As the
elements are treated sequentially from the left to the right, the product
operator '*' shall always be used before the '+' operators (e.g.
'SE * LIN + RQ' is valid whereas 'RQ + SE * LIN' is  not). Recovered from
<code>trained_model</code> if not provided.</p></li>
</ul></dd>


<dt id="arg-kern-i">kern_i<a class="anchor" aria-label="anchor" href="#arg-kern-i"></a></dt>
<dd><p>A kernel function, associated with the individual GPs. ("SE",
"PERIO" and "RQ" are aso available here). Recovered from
<code>trained_model</code> if not provided.</p></dd>


<dt id="arg-prior-mean">prior_mean<a class="anchor" aria-label="anchor" href="#arg-prior-mean"></a></dt>
<dd><p>Hyper-prior mean parameter of the mean GP. This argument,
can be specified under various formats, such as:</p><ul><li><p>NULL (default). The hyper-prior mean would be set to 0 everywhere.</p></li>
<li><p>A number. The hyper-prior mean would be a constant function.</p></li>
<li><p>A vector of the same length as all the distinct Input values in the
<code>data</code> argument. This vector would be considered as the evaluation
of the hyper-prior mean function at the training Inputs.</p></li>
<li><p>A function. This function is defined as the hyper-prior mean.</p></li>
<li><p>A tibble or data frame. Required columns: Input, Output. The Input
values should include at least the same values as in the <code>data</code>
argument.</p></li>
</ul></dd>


<dt id="arg-grid-inputs">grid_inputs<a class="anchor" aria-label="anchor" href="#arg-grid-inputs"></a></dt>
<dd><p>A vector or a data frame, indicating the grid of
additional reference inputs on which the mean process' hyper-posterior
should be evaluated.</p></dd>


<dt id="arg-pen-diag">pen_diag<a class="anchor" aria-label="anchor" href="#arg-pen-diag"></a></dt>
<dd><p>A number. A jitter term, added on the diagonal to prevent
numerical issues when inverting nearly singular matrices.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list gathering the parameters of the mean processes'
hyper-posterior distributions, namely:</p><ul><li><p>mean: A tibble, the hyper-posterior mean parameter
evaluated at each training <code>Input</code>.</p></li>
<li><p>cov: A matrix, the covariance parameter for the
hyper-posterior distribution of the mean process.</p></li>
<li><p>pred: A tibble, the predicted mean and variance at
<code>Input</code> for the mean process' hyper-posterior
distribution under a format that allows the direct
visualisation as a GP prediction.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="cn">TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Arthur Leroy, Pierre Latouche.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

