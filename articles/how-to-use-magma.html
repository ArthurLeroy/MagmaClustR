<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MagmaClustR">
<title>How to use Magma â€¢ MagmaClustR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to use Magma">
<meta property="og:description" content="MagmaClustR">
<meta property="og:image" content="https://arthurleroy.github.io/MagmaClustR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MagmaClustR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/example-in-2D.html">Multi-dimensional inputs in Magma</a>
    <a class="dropdown-item" href="../articles/how-to-use-magma.html">How to use Magma</a>
    <a class="dropdown-item" href="../articles/how-to-use-magmaclust.html">How to use MagmaClust</a>
    <a class="dropdown-item" href="../articles/standard-GP.html">Gaussian Process regression</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ArthurLeroy/MagmaClustR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>How to use Magma</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ArthurLeroy/MagmaClustR/blob/HEAD/vignettes/articles/how-to-use-magma.Rmd" class="external-link"><code>vignettes/articles/how-to-use-magma.Rmd</code></a></small>
      <div class="d-none name"><code>how-to-use-magma.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ArthurLeroy/MagmaClustR" class="external-link">MagmaClustR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/is_installed.html" class="external-link">is_installed</a></span><span class="op">(</span><span class="st">"gridExtra"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<div class="section level2">
<h2 id="context">Context<a class="anchor" aria-label="anchor" href="#context"></a>
</h2>
<p>To explore the different features of <em>Magma</em>, we use the
<code>swimmers</code> dataset provided by the French Swimming Federation
(available <a href="https://github.com/ArthurLeroy/MAGMAclust/blob/master/Real_Data_Study/Data/db_100m_freestyle.csv" class="external-link">here</a>,
and studied more thoroughly <a href="https://link.springer.com/article/10.1007/s10994-022-06172-1" class="external-link">here</a>
and <a href="https://arxiv.org/abs/2011.07866" class="external-link">there</a>).</p>
<p>This dataset gathers competition results in 100m freestyle events
between 2002 and 2016 for 1725 men and 1731 women, and a total of 38481
and 38351 performances, respectively.</p>
<p>Throughout this <code>swimmers</code> example, we use Magma as a
decision support tool to detect promising young athletes, which is a
classical problem in an elite sport context. More specifically, Magma is
used to model swimmers progression curves and forecast their future
performances. Indeed, a multi-task GPs model offers new perspectives
like probabilistic predictions, which provides insights to sport
structures for their future decisions.</p>
<p>More generally, our task is to train a model with a large dataset and
predict a new individual thanks to shared information.</p>
<p>To get a better idea of the <code>swimmers</code> dataset content, we
display the performances of 5 swimmers according to their age. Do all
the swimmers progress the same, <em>i.e.</em> with the same pattern? Do
the most successful young swimmers remain the best when they get older?
Those are the kind of questions we aim to tackle in the following.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">swimmers</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Age</span>,y<span class="op">=</span><span class="va">Performance</span>,colour<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="how-to-use-magma_files/figure-html/unnamed-chunk-3-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>This plot highlights the sparsity and irregularity of our functional
data; swimmers performances are observed irregularly, with some areas
containing very few observations (particularly for the younger ages).
Moreover, it clearly appears that there are different swimmer profiles,
especially due to different evolutions of morphology during teen years.
Therefore, it might be important to take them into account if one wants
to improve the quality of talent detection strategies.</p>
<div class="section level3">
<h3 id="dataset-format">Dataset format<a class="anchor" aria-label="anchor" href="#dataset-format"></a>
</h3>
<p>The <code>swimmers</code> dataset contains 4 columns:
<code>ID</code>, <code>Age</code>, <code>Performance</code> and
<code>Gender</code>. Each row represents a performance realised by a
swimmer at a given age. More specifically, each column contains:</p>
<ul>
<li>
<code>ID</code>, the identifying number associated with each
swimmer;</li>
<li>
<code>Age</code>, the age of the swimmer at the moment of the
performance;</li>
<li>
<code>Performance</code>, the chronometric performance on a 100m
freestyle (in seconds);</li>
<li>
<code>Gender</code>, a number indicating the competitive gender of
the swimmer (1 corresponds to men and 2 to women).</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">swimmers</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">ID</th>
<th align="right">Age</th>
<th align="right">Performance</th>
<th align="right">Gender</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">14.88</td>
<td align="right">57.68</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">14.91</td>
<td align="right">56.35</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">15.26</td>
<td align="right">56.34</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">15.41</td>
<td align="right">55.90</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">15.59</td>
<td align="right">56.07</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>If new variables (such as weight, height, number of training hours â€¦)
would have been observed, any additional column would be treated as a
covariate, and thus result in a model with multi-dimensional inputs.</p>
<p>Before starting to use <em>Magma</em>, we must ensure that our
dataset contains at least the three following mandatory columns with
adequate type: - <code>ID</code>: <code>character</code> or
<code>factor</code>; - <code>Input</code>: <code>numeric</code>; -
<code>Output</code>: <code>numeric</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="classical-pipeline">Classical pipeline<a class="anchor" aria-label="anchor" href="#classical-pipeline"></a>
</h2>
<p>The overall process of the <em>Magma</em> algorithm can be decomposed
in 3 main steps: <strong>training, prediction</strong> and
<strong>plotting the results</strong>. The corresponding functions
are:</p>
<ul>
<li><a href="https://arthurleroy.github.io/MagmaClustR/reference/train_magma.html"><code>train_magma()</code></a></li>
<li><a href="https://arthurleroy.github.io/MagmaClustR/reference/pred_magma.html"><code>pred_magma()</code></a></li>
<li><a href="https://arthurleroy.github.io/MagmaClustR/reference/plot_gp.html"><code>plot_gp()</code></a></li>
</ul>
</div>
<div class="section level2">
<h2 id="applying-magma-on-the-swimmer-dataset">Applying Magma on the swimmer dataset<a class="anchor" aria-label="anchor" href="#applying-magma-on-the-swimmer-dataset"></a>
</h2>
<div class="section level3">
<h3 id="data-organisation">Data organisation<a class="anchor" aria-label="anchor" href="#data-organisation"></a>
</h3>
<p>For the sake of consistency, we split male and female swimmers into
different datasets: <code>swimmers_m</code> and <code>swimmers_f</code>.
The following study is dedicated to women performances and thus focus on
the <code>swimmers_f</code> dataset.</p>
<p>In addition, we need to change the name of the input and output
columns as indicated before, and remove the <code>Gender</code> one.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">swimmers_m</span> <span class="op">&lt;-</span> <span class="va">swimmers</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Gender</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Gender</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Input <span class="op">=</span> <span class="va">Age</span>, Output <span class="op">=</span> <span class="va">Performance</span><span class="op">)</span></span>
<span></span>
<span><span class="va">swimmers_f</span> <span class="op">&lt;-</span> <span class="va">swimmers</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Gender</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Gender</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Input <span class="op">=</span> <span class="va">Age</span>, Output <span class="op">=</span> <span class="va">Performance</span><span class="op">)</span></span></code></pre></div>
<p>To continue this data management procedure, the swimmers are
allocated into two groups:</p>
<ul>
<li>those we use to train the model;</li>
<li>the one for whom we predict future performances; letâ€™s give her the
fictive name <em>Michaela</em>.</li>
</ul>
<p>To limit computation time in this illustrative example, we randomly
select 20 swimmers for training. Even if the performances of
<em>Magma</em> increase with the number of training individuals, 20 are
more than enough to get a clear idea of how the algorithm works.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">list_ID</span> <span class="op">&lt;-</span> <span class="va">swimmers_f</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">swimmers_train</span> <span class="op">&lt;-</span> <span class="va">swimmers_f</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">list_ID</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">swimmers_pred</span> <span class="op">&lt;-</span> <span class="va">swimmers_f</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">1718</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">swimmers_train</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Input</span>,y<span class="op">=</span><span class="va">Output</span>,colour<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1.5</span>,alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">swimmers_pred</span>,</span>
<span>             size<span class="op">=</span><span class="fl">3</span>,</span>
<span>             shape<span class="op">=</span><span class="fl">17</span>,</span>
<span>             color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="how-to-use-magma_files/figure-html/unnamed-chunk-7-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The triangles correspond to Michaelaâ€™s performances, whereas the
coloured dots represent the swimmers data we use for training.</p>
</div>
<div class="section level3">
<h3 id="training">Training<a class="anchor" aria-label="anchor" href="#training"></a>
</h3>
<p>Itâ€™s now time to train the model thanks to
<code><a href="../reference/train_magma.html">train_magma()</a></code>, for which several arguments can be
specified:</p>
<ul>
<li><p><code>prior_mean</code>: if we assume no <em>prior</em> knowledge
about the 100m freestyle, we can decide to leave the default value for
this parameter (<em>i.e.</em> zero). However, if we want to take expert
advice into account, we can modify the value of <code>prior_mean</code>
accordingly.</p></li>
<li><p><code>kern</code>: the relationship between observed data and
prediction targets can be control through the covariance
<strong>kernel</strong>. Therefore, in order to correctly fit our data,
we need to choose a suitable covariance kernel. In the case of swimmers,
we want a smooth progression curve for Michaela; therefore, we specify
<code>kern = "SE"</code>.</p></li>
</ul>
<p>The most commonly used kernels and their properties are discussed in
<a href="https://www.cs.toronto.edu/~duvenaud/cookbook/" class="external-link">the kernel
cookbook</a>. Details of available kernels and how to combine them in
the package are available in <a href="https://arthurleroy.github.io/MagmaClustR/reference/train_magma.html"><code>help(train_magma)</code></a>.</p>
<ul>
<li>
<code>common_hp</code>: here, we assume that the set of
hyper-parameters is common to all individuals. Thus, we model a context
where individuals represent different trajectories of the same process,
whereas different hyper-parameters indicate different covariance
structures and thus a more flexible model.</li>
</ul>
<p>As for any GP method, initialisation of the hyper-parameters may have
an influence on the final optimisation and lead to inadequate prediction
for pathological cases. Therefore, users may explicitly define specific
initial values through the dedicated <code>ini_hp</code> argument.</p>
<p>Other parameters can also be specified; see <a href="https://arthurleroy.github.io/MagmaClustR/reference/train_magma.html"><code>help(train_magma)</code></a>
for details.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train_magma.html">train_magma</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">swimmers_train</span>,</span>
<span>                     kern_0 <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>                     kern_i <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>                     common_hp <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; The 'prior_mean' argument has not been specified. The hyper_prior mean function is thus set to be 0 everywhere.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; The 'ini_hp_0' argument has not been specified. Random values of hyper-parameters for the mean process are used as initialisation.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; The 'ini_hp_i' argument has not been specified. Random values of hyper-parameters for the individal processes are used as initialisation.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; EM algorithm, step 1: 16.67 seconds </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Value of the likelihood: -1306.81108 --- Convergence ratio = Inf</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; EM algorithm, step 2: 9.99 seconds </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Value of the likelihood: -1240.19542 --- Convergence ratio = 0.05371</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; EM algorithm, step 3: 5.82 seconds </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Value of the likelihood: -1228.40746 --- Convergence ratio = 0.0096</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; EM algorithm, step 4: 7.14 seconds </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Value of the likelihood: -1225.57666 --- Convergence ratio = 0.00231</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; EM algorithm, step 5: 7.19 seconds </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Value of the likelihood: -1225.34949 --- Convergence ratio = 0.00019</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; The EM algorithm successfully converged, training is completed. </span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prediction-for-michaela">Prediction for Michaela<a class="anchor" aria-label="anchor" href="#prediction-for-michaela"></a>
</h3>
<p>As the <em>Magma</em> model is trained, we can now predict to predict
the evolution of Michaelaâ€™s performances. To perform prediction, we need
to specify two main parameters in the <code><a href="../reference/pred_magma.html">pred_magma()</a></code>
function:</p>
<ul>
<li>
<code>data</code>: in our case, the sub-dataset containing
Michaelaâ€™s current performances;</li>
<li>
<code>trained_model</code>, which corresponds to the model we just
trained with the other 20 swimmers.</li>
</ul>
<p>Let us mention that improvements in swimming are more prominent
during young ages, thus we here aim to predict the evolution of
Michaelaâ€™s performances between 10 and 20 years. Therefore, the argument
<code>grid_inputs = seq(10,20,0.1)</code> can be set to compute such a
forecast of interest.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pred_magma.html">pred_magma</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">swimmers_pred</span>,</span>
<span>  trained_model <span class="op">=</span> <span class="va">model</span>,</span>
<span>  grid_inputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; The hyper-posterior distribution of the mean process provided in 'hyperpost' argument isn't evaluated on the expected inputs.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  Start evaluating the hyper-posterior on the correct inputs...</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; The 'prior_mean' argument has not been specified. The hyper-prior mean function is thus set to be 0 everywhere.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Done!</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h3>
<p>The <a href="https://arthurleroy.github.io/MagmaClustR/reference/plot_gp.html"><code>plot_gp()</code></a>
function can be used to depict the evolution of Michaelaâ€™s predicted
performances.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_gp.html">plot_gp</a></span><span class="op">(</span>pred_gp <span class="op">=</span> <span class="va">pred</span>,</span>
<span>        data <span class="op">=</span> <span class="va">swimmers_pred</span>,</span>
<span>        prior_mean <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">hyperpost</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>        data_train <span class="op">=</span> <span class="va">swimmers_train</span><span class="op">)</span> </span></code></pre></div>
<p><img src="how-to-use-magma_files/figure-html/unnamed-chunk-10-1.png" width="80%" style="display: block; margin: auto;">
In the above figure, we can observe:</p>
<ul>
<li><p>the prediction curve (purple line) and its associated 95%
credibility interval (pink band);</p></li>
<li><p>the training data points in the background (displayed through
<code>data_train</code>). Each colour corresponds to one
swimmer;</p></li>
<li><p>the trained mean process as a dashed black line coming from the
<code>prior_mean</code> parameter.</p></li>
</ul>
<div class="section level4">
<h4 id="magma-vs-classic-gp">Magma VS classic GP<a class="anchor" aria-label="anchor" href="#magma-vs-classic-gp"></a>
</h4>
<p>The <em>MagmaClustR</em> package also provides an implementation of
the standard GP regression, which we can compare to <em>Magma</em> in
this example. For more details on how to fit a single GP, see <a href="Lien">Vignette GPs</a>.</p>
<p>The graphs below correspond to predictions of Michaelaâ€™s performances
between 10 and 23 years, according to <em>Magma</em> (left) and standard
GP (right).</p>
<p><img src="how-to-use-magma_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>On this visual comparison, 3 distinct phases can be highlighted:</p>
<ul>
<li><p><strong>first phase</strong>: close to Michaelaâ€™s observed data
(<span class="math inline">\(t \in [ 11, 14 ]\)</span>), the two
processes behave similarly. We note a slight increase in the variance
for Magma, which is logical since the prediction also takes uncertainty
over the <strong>mean GP</strong> into account;</p></li>
<li><p><strong>second phase</strong>: on intervals of unobserved
timestamps containing data points from the training dataset (<span class="math inline">\(t \in [ 14, 20 ]\)</span>), Magma prediction is
guided by the information coming from other individuals through the
<strong>mean GP</strong>. Thus, the mean trajectory remains coherent and
the uncertainty increases only slightly. On the contrary, the simple GP
quickly drifts to the prior zero mean as soon as data lack, and
uncertainty increases significantly.</p></li>
<li><p><strong>third phase</strong>: where no observations are
available, neither from the new individual nor the training dataset
(<span class="math inline">\(t &gt; 20\)</span>), Magma behaves as
expected, with a slow drift to the prior mean, with highly increasing
variance.</p></li>
</ul>
<p>Therefore, the main improvement in prediction brought by Magma lies
in the <strong>second phase</strong> thanks to information shared across
individuals.</p>
<p>Overall, the multi-task framework provides reliable probabilistic
predictions for a new swimmer on a wider range of timestamps,
potentially outside of the usual scope of GPs. Furthermore, the
uncertainty provided through the predictive posterior distribution
offers an adequate degree of caution in a decision-making process.</p>
</div>
<div class="section level4">
<h4 id="comparison-of-individuals">Comparison of individuals<a class="anchor" aria-label="anchor" href="#comparison-of-individuals"></a>
</h4>
<p>To compare the evolution on both genders, we display below the
progression curves predicted by <em>Magma</em> for a fictive male
swimmer, called Michael (right) and randomly selected within
<code>swimmers_m</code>, along with the one for Michaela (left).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Draw a random subset for training and an individual for prediction</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">list_ID_m</span> <span class="op">&lt;-</span> <span class="va">swimmers_m</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">swimmers_train_m</span> <span class="op">&lt;-</span> <span class="va">swimmers_m</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">list_ID_m</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">swimmers_pred_m</span> <span class="op">&lt;-</span> <span class="va">swimmers_m</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">list_ID_m</span><span class="op">[</span><span class="fl">24</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Train Magma on the male swimmers sub-dataset</span></span>
<span><span class="va">model_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train_magma.html">train_magma</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">swimmers_train_m</span>,</span>
<span>                        kern_0 <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>                        kern_i <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>                        common_hp <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; The 'prior_mean' argument has not been specified. The hyper_prior mean function is thus set to be 0 everywhere.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; The 'ini_hp_0' argument has not been specified. Random values of hyper-parameters for the mean process are used as initialisation.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; The 'ini_hp_i' argument has not been specified. Random values of hyper-parameters for the individal processes are used as initialisation.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; EM algorithm, step 1: 19.36 seconds </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Value of the likelihood: -1429.75903 --- Convergence ratio = Inf</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; EM algorithm, step 2: 6.24 seconds </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Value of the likelihood: -1411.53737 --- Convergence ratio = 0.01291</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; EM algorithm, step 3: 6.22 seconds </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Value of the likelihood: -1409.82806 --- Convergence ratio = 0.00121</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; EM algorithm, step 4: 8 seconds </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Value of the likelihood: -1408.13089 --- Convergence ratio = 0.00121</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; EM algorithm, step 5: 8.16 seconds </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Value of the likelihood: -1408.09953 --- Convergence ratio = 2e-05</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; The EM algorithm successfully converged, training is completed. </span></span>
<span><span class="co">#&gt; </span></span>
<span></span>
<span><span class="co">## Compute a prediction for Michael </span></span>
<span><span class="va">pred_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pred_magma.html">pred_magma</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">swimmers_pred_m</span>,</span>
<span>  trained_model <span class="op">=</span> <span class="va">model_m</span>,</span>
<span>  grid_inputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; The hyper-posterior distribution of the mean process provided in 'hyperpost' argument isn't evaluated on the expected inputs.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  Start evaluating the hyper-posterior on the correct inputs...</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; The 'prior_mean' argument has not been specified. The hyper-prior mean function is thus set to be 0 everywhere.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Done!</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p><img src="how-to-use-magma_files/figure-html/unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>We can note that both genders present similar patterns of
progression: a quick improvement of performances at young ages, then a
slowdown in progress that can even leads to a stagnation afterwards.</p>
<p>However, while performances are roughly similar in mean trend before
the age of 14, they start to differentiate afterwards and then converge
to average times with approximately a 5sec gap. Interestingly, the
difference between men and women world records in swimming 100m
freestyle competitions is currently 4.8sec (46.91 versus 51.71), which
is consistent with the difference between convergence times of the two
mean processes.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="customise-graphs">Customise graphs<a class="anchor" aria-label="anchor" href="#customise-graphs"></a>
</h2>
<div class="section level3">
<h3 id="with-plot_gp">With plot_gp()<a class="anchor" aria-label="anchor" href="#with-plot_gp"></a>
</h3>
<p>In case of 1-dimensional inputs, we can depict Michaelaâ€™s prediction
graphs thanks to the <code><a href="../reference/plot_gp.html">plot_gp()</a></code> function. Indeed, if by
setting the argument <code>heatmap = TRUE</code>, we can display a
heatmap of probabilities instead using a 95% credibility interval. Doing
so, we get a thorough visual quantification for both the dispersion of
the predicted values and the confidence we may grant to each of
them.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_gp.html">plot_gp</a></span><span class="op">(</span>pred_gp <span class="op">=</span> <span class="va">pred_f</span>,</span>
<span>        data <span class="op">=</span> <span class="va">swimmers_pred</span>,</span>
<span>        data_train <span class="op">=</span> <span class="va">swimmers_train</span>,</span>
<span>        prior_mean <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">hyperpost</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>        heatmap <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="how-to-use-magma_files/figure-html/unnamed-chunk-16-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="create-a-gif">Create a GIF<a class="anchor" aria-label="anchor" href="#create-a-gif"></a>
</h3>
<p>If we want to create animated representations, please use the <a href="https://arthurleroy.github.io/MagmaClustR/reference/pred_gif.html"><code>pred_gif()</code></a>
and <a href="https://arthurleroy.github.io/MagmaClustR/reference/plot_gif.html"><code>plot_gif()</code></a>
functions, instead of <code><a href="../reference/pred_magma.html">pred_magma()</a></code> and
<code><a href="../reference/plot_gp.html">plot_gp()</a></code>. These functions offer dynamic plots by
generating GIFs thanks to the <code>gganimate</code> package. Such
graphs exhibit how the GP prediction evolves as we observe more data
points.</p>
<p><code><a href="../reference/pred_gif.html">pred_gif()</a></code> and <code><a href="../reference/plot_gif.html">plot_gif()</a></code> functions work
the same as <code><a href="../reference/pred_magma.html">pred_magma()</a></code> and <code><a href="../reference/plot_gp.html">plot_gp()</a></code> (except
that no <code>plot</code> argument is required in
<code><a href="../reference/pred_gif.html">pred_gif()</a></code>). Some extra arguments can be customized in
<code><a href="../reference/plot_gif.html">plot_gif()</a></code>, like adjusting the GIF speed, saving the
plotted GIF (see <code>?gganimate</code> for details)</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred_gif</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pred_gif.html">pred_gif</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">swimmers_pred</span>,</span>
<span>  trained_model <span class="op">=</span> <span class="va">model</span>,</span>
<span>  grid_inputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  =&gt; 1 =&gt; 2 =&gt; 3 =&gt; 4 =&gt; 5 =&gt; 6 =&gt; 7 =&gt; 8 =&gt; 9 =&gt; 10 =&gt; 11 =&gt; 12 =&gt; 13 =&gt; 14 =&gt; 15 =&gt; 16 =&gt; 17</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_gif.html">plot_gif</a></span><span class="op">(</span>pred_gp <span class="op">=</span> <span class="va">pred_gif</span>,</span>
<span>         data <span class="op">=</span> <span class="va">swimmers_pred</span>,</span>
<span>         data_train <span class="op">=</span> <span class="va">swimmers_train</span>,</span>
<span>         prior_mean <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">hyperpost</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>         alpha_data_train <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<p><img src="../../docs/articles/how-to-use-magma_files/figure-html/unnamed-chunk-18-1.gif" width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<p>This example highlights the interest of using a multi-task GP to
predict swimmers performances. However, the results are not restricted
to this illustrative study. For further details, the complete derivation
of the algorithm and experiments are published and available in <a href="https://link.springer.com/content/pdf/10.1007/s10994-022-06172-1.pdf" class="external-link">MAGMA:
inference and prediction using multi-task Gaussian processes with common
mean</a>.</p>
</div>
<div class="section level2">
<h2 id="to-go-further-from-magma-to-magmaclust">To go further: from Magma to MagmaClust<a class="anchor" aria-label="anchor" href="#to-go-further-from-magma-to-magmaclust"></a>
</h2>
<p>To underline the main limitation of Magma, we now propose to predict
the performances of an elite female swimmer in the dataset (under 60sec)
instead of Michaelaâ€™s.</p>
<p><img src="how-to-use-magma_files/figure-html/unnamed-chunk-21-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Due to the high level of this swimmer, all of her performances are
far below the mean GP. Thus, when we try to predict her future
evolution, we may actually underestimate her potential; indeed, her
progression curve increases significantly once she has no data left,
until it reaches the mean process. Although, this behaviour is expected
since the prediction is guided by the information coming from other
individuals (through the mean process) who are less successful than her,
the method could benefit from accounting for differences between
individual in the training dataset.</p>
<p>This is why enabling cluster-specific mean processes to take into
account different swimmers profiles would be a relevant extension. This
enhancement of <em>Magma</em> corresponds to the <em>MagmaClust</em>
algorithm; see the corresponding <a href="https://arthurleroy.github.io/MagmaClustR/articles/how-to-use-magmaclust.html">vignette</a>
for further information.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Arthur Leroy, Pierre Latouche.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
