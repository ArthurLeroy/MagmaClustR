<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MagmaClustR">
<title>Gaussian Process regression • MagmaClustR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Gaussian Process regression">
<meta property="og:description" content="MagmaClustR">
<meta property="og:image" content="https://arthurleroy.github.io/MagmaClustR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MagmaClustR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/example-in-2D.html">Multi-dimensional inputs in Magma</a>
    <a class="dropdown-item" href="../articles/how-to-use-magma.html">How to use Magma</a>
    <a class="dropdown-item" href="../articles/how-to-use-magmaclust.html">How to use MagmaClust</a>
    <a class="dropdown-item" href="../articles/standard-GP.html">Gaussian Process regression</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ArthurLeroy/MagmaClustR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Gaussian Process regression</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ArthurLeroy/MagmaClustR/blob/HEAD/vignettes/articles/standard-GP.Rmd" class="external-link"><code>vignettes/articles/standard-GP.Rmd</code></a></small>
      <div class="d-none name"><code>standard-GP.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ArthurLeroy/MagmaClustR" class="external-link">MagmaClustR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="classical-pipeline">Classical pipeline<a class="anchor" aria-label="anchor" href="#classical-pipeline"></a>
</h2>
<p>The overall pipeline for standard GP regression in
<em>MagmaClustR</em> can be decomposed in 3 main steps:
<strong>training, prediction</strong> and <strong>plotting of
results</strong>. The corresponding functions are:</p>
<ul>
<li><a href="https://arthurleroy.github.io/MagmaClustR/reference/train_magma.html"><code>train_gp()</code></a></li>
<li><a href="https://arthurleroy.github.io/MagmaClustR/reference/pred_gp.html"><code>pred_gp()</code></a></li>
<li><a href="https://arthurleroy.github.io/MagmaClustR/reference/plot_gp.html"><code>plot_gp()</code></a></li>
</ul>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<div class="section level3">
<h3 id="dataset-format">Dataset format<a class="anchor" aria-label="anchor" href="#dataset-format"></a>
</h3>
<p>Before using <code><a href="../reference/train_gp.html">train_gp()</a></code>, our dataset should present a
particular format. It must contains those 2 columns:</p>
<ul>
<li>
<code>Input</code>: <code>numeric</code>,</li>
<li>
<code>Output</code>: <code>numeric</code>.</li>
</ul>
<p>If we fail to ensure that the dataset satisfies those conditions, the
algorithm will return an error.</p>
<p>The data frame can also provide as many covariates (<em>i.e.</em>
additional columns) as desired, with no constraints on the column names
(except the name ‘Reference’ that should always be avoided, as it is
used inside internal functions of the algorithm). These covariates are
treated as additional input dimensions.</p>
</div>
<div class="section level3">
<h3 id="example-with-swimming-data">Example with swimming data<a class="anchor" aria-label="anchor" href="#example-with-swimming-data"></a>
</h3>
<p>To explore the features of standard GP in <em>MagmaClustR</em>, we
use the <code>swimmers</code> dataset provided by the French Swimming
Federation (available <a href="https://github.com/ArthurLeroy/MAGMAclust/blob/master/Real_Data_Study/Data/db_100m_freestyle.csv" class="external-link">here</a>,
and studied more thoroughly <a href="https://link.springer.com/article/10.1007/s10994-022-06172-1" class="external-link">here</a>
and <a href="https://arxiv.org/abs/2011.07866" class="external-link">there</a>).</p>
<p>Our goal is to model the progression curves of swimmers in order to
forecast their future performances. Thus, we randomly select a female
swimmer from the dataset; let’s give her the fictive name
<em>Michaela</em> for the sake of illustration.</p>
<p>The <code>swimmers</code> dataset contains 4 columns:
<code>ID</code>, <code>Age</code>, <code>Performance</code> and
<code>Gender</code>. Therefore, we first need to change the name and
type of the columns, and remove <code>Gender</code> before using
<code><a href="../reference/train_gp.html">train_gp()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Michaela</span> <span class="op">&lt;-</span> <span class="va">swimmers</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">1718</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Gender</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>Input <span class="op">=</span> <span class="va">Age</span>, Output <span class="op">=</span> <span class="va">Performance</span><span class="op">)</span></span></code></pre></div>
<p>We display Michaela’s performances according to her age to visualise
her progression from raw data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Michaela</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Input</span>,y<span class="op">=</span><span class="va">Output</span><span class="op">)</span>,</span>
<span>       size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>       colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="standard-GP_files/figure-html/unnamed-chunk-4-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="fit-a-gp-on-michaelas-data-points">Fit a GP on Michaela’s data points<a class="anchor" aria-label="anchor" href="#fit-a-gp-on-michaelas-data-points"></a>
</h2>
<div class="section level3">
<h3 id="training">Training<a class="anchor" aria-label="anchor" href="#training"></a>
</h3>
<p>To obtain a GP that best fits our data, we must specify some
parameters:</p>
<ul>
<li><p><code>prior_mean</code>: if we assume no <em>prior</em> knowledge
about the 100m freestyle, we can decide to leave the default value for
this parameter (<em>i.e.</em> zero). However, if we want to take expert
advice into account, we can modify the value of <code>prior_mean</code>
accordingly.</p></li>
<li><p><code>kern</code>: the relationship between observed data and
prediction targets can be control through the covariance
<strong>kernel</strong>. Therefore, in order to correctly fit our data,
we need to choose a suitable covariance kernel. In the case of swimmers,
we want a smooth progression curve for Michaela; therefore, we specify
<code>kern = "SE"</code>.</p></li>
</ul>
<p>The most commonly used kernels and their properties are covered in <a href="https://www.cs.toronto.edu/~duvenaud/cookbook/" class="external-link">the kernel
cookbook</a>. Details of available kernels and how to combine them in
<em>MagmaClustR</em> are available in <a href="https://arthurleroy.github.io/MagmaClustR/reference/train_gp.html"><code>help(train_gp)</code></a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">model_gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train_gp.html">train_gp</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Michaela</span>,</span>
<span>                     kern <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>                     prior_mean <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; The provided 'prior_mean' argument is of length 1. Thus, the hyper-posterior mean function has set to be constant everywhere. </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; The 'ini_hp' argument has not been specified. Random values of hyper-parameters are used as initialisation.</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>Thanks to <code><a href="../reference/train_gp.html">train_gp()</a></code>, we learn the model
hyper-parameters from data, which can then be used to make prediction
for Michaela’s performances.</p>
</div>
<div class="section level3">
<h3 id="gp-prediction">GP prediction<a class="anchor" aria-label="anchor" href="#gp-prediction"></a>
</h3>
<p>The arguments <code>kern</code> and <code>mean</code> remain the same
as above. We now need to specify:</p>
<ul>
<li>the hyper-parameters obtained with <code><a href="../reference/train_gp.html">train_gp()</a></code> in
<code>hp</code>;</li>
<li>the input values on which we want to evaluate our GP in
<code>grid_inputs</code>. Here, we want to predict Michaela’s
performances until 15/16 years old, so we set
<code>grid_inputs = seq(11, 15.5, 0.1)</code>.</li>
</ul>
<p>See <a href="https://arthurleroy.github.io/MagmaClustR/reference/pred_gp.html"><code>help(pred_gp)</code></a>
to get information about the other optional arguments.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred_gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pred_gp.html">pred_gp</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Michaela</span>,</span>
<span>                   kern <span class="op">=</span> <span class="st">"SE"</span>,</span>
<span>                   hp <span class="op">=</span> <span class="va">model_gp</span>,</span>
<span>                   grid_inputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">15.5</span>,<span class="fl">0.1</span><span class="op">)</span>,</span>
<span>                   plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="co">#&gt; The 'mean' argument has not been specified. The  mean function is thus set to be 0 everywhere.</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p>Let us note that we could have called the <code><a href="../reference/pred_gp.html">pred_gp()</a></code>
function directly on data. If we didn’t use the <code><a href="../reference/train_gp.html">train_gp()</a></code>
function beforehand, it is possible to omit the <code>hp</code>
parameter; <code><a href="../reference/pred_gp.html">pred_gp()</a></code> would automatically learn
hyperparameters with default settings and us them to make predictions
afterwards.</p>
</div>
<div class="section level3">
<h3 id="plotting-the-results">Plotting the results<a class="anchor" aria-label="anchor" href="#plotting-the-results"></a>
</h3>
<p>Finally, we display Michaela’s prediction curve and its 95%
associated credibility interval thanks to the <code><a href="../reference/plot_gp.html">plot_gp()</a></code>
function. If we want to get a prettier graphic, we could specify
<code>heatmap = TRUE</code> to create a heatmap of probabilities instead
(note that it could be longer to display when evaluating on fine
grids).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_gp.html">plot_gp</a></span><span class="op">(</span>pred_gp <span class="op">=</span> <span class="va">pred_gp</span>,</span>
<span>        data <span class="op">=</span> <span class="va">Michaela</span><span class="op">)</span></span></code></pre></div>
<p><img src="standard-GP_files/figure-html/unnamed-chunk-7-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Close to Michaela’s observed data (<span class="math inline">\(t \in
[ 10, 14 ]\)</span>), the standard GP prediction behaves as expected: it
accurately fits data points and the confidence interval is narrow.
However, as soon as we move away from observed points, the GP drifts to
the <strong>prior mean</strong> and uncertainty increases
significantly.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Arthur Leroy, Pierre Latouche.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
